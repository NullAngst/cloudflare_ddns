# Cloudflare DDNS Updater & Generator

A lightweight, secure Bash script to dynamically update Cloudflare DNS records using API Tokens (Bearer Auth), accompanied by a local HTML dashboard to help generate your configuration and cron schedules.
## üìÇ Files Included

- cloudflare_ddns.sh: The core logic. A Bash script that detects your public IP, compares it to the existing Cloudflare record, and updates it only if necessary.

- cloudflare_ddns.html: A standalone "offline" web tool. It provides a GUI to input your credentials and generates the specific cron schedule and script parameters for you.

## ‚ú® Features

- Secure Authentication: Uses Cloudflare API Tokens (Bearer Auth) instead of the Global API Key. This allows you to scope permissions strictly to "Edit Zone DNS" for better security.

- Minimal Dependencies: Relies only on standard tools: curl, grep, and cut (no jq required).

- Bandwidth Friendly: Checks your current IP against the Cloudflare API record before attempting an update to prevent unnecessary API calls.

- Configuration Helper: Includes a dark-themed HTML dashboard to help visualize the script setup and generate the correct Crontab syntax.

## üöÄ Prerequisites

- A Cloudflare account with a domain managed by Cloudflare.

- A Linux environment (Ubuntu, Debian, CentOS, Raspberry Pi OS, etc.).

- curl installed (sudo apt install curl).

## üõ†Ô∏è Setup Guide
### Step 1: Get Cloudflare Credentials

- Go to your Cloudflare Dashboard.

- Navigate to User Profile > API Tokens.

- Create a Token using the Edit Zone DNS template.

- Copy the Zone ID from the "Overview" page of your domain.

### Step 2: Configure the Script
You can configure the script manually or use the included HTML helper.

### Option A: Using the HTML Helper

- Download and open cloudflare_ddns.html in any web browser.

- Enter your API Token, Zone ID, and Record Name (e.g., vpn.example.com).

- Choose your desired update frequency (e.g., Every 5 Minutes).

- The tool will generate the cron line and script preview for you.

### Option B: Manual Configuration

- Download cloudflare_ddns.sh to your server (e.g., /home/user/scripts/).

- Open the file and edit the Configuration section

### Step 3: Permissions & Testing

- Make the script executable:
```
chmod +x cloudflare_ddns.sh
```
- Run the script manually to ensure it works:
```
./cloudflare_ddns.sh
```
- Expected Output:

`Current Public IP: 123.123.123.123 Cloudflare IP: 123.123.123.123 IP has not changed. No update needed.`

### Step 4: Automation (Cron Job)

To keep your IP updated automatically, add a cron job.

- Open the crontab editor:
```
crontab -e
```
- Add the line generated by the HTML tool, or use the example below (runs every 5 minutes):
```
    */5 * * * * /bin/bash /path/to/cloudflare_ddns.sh >/dev/null 2>&1
```
## üìù Troubleshooting

- "Authentication failed": Ensure you are using an API Token, not your Global API Key. The token permissions must include Zone - DNS - Edit.

- "Could not find record": The DNS record (e.g., vpn.mydomain.com) must already exist in Cloudflare. This script updates existing records; it does not create new ones.

- Proxy Status: If you want the IP hidden behind Cloudflare, set proxied="true". If you need direct connection (e.g., for SSH or VPN), set proxied="false".

# Disclaimer: This script is provided as-is. Always verify your firewall rules and ensure your API tokens are kept secret.
